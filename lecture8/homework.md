# Домашнее задание

## Файловый органайзер

С помощью Cobra написать CLI-утилиту для сортировки файлов
в директории по их расширениям (например, .pdf, .docx).

### 1. Конфигурация

Утилита должна с использованием Viper читать
из конфигурационного файла `app_config.yaml` следующую информацию:

- целевую директорию для органайзера (директорию,
  где он будет сортировать файлы).
- имена папок для разных типов файлов (например, PDFs для .pdf).
  Нужно задать эту информацию в виде мапы (ключ -- расширение файла,
  значение -- название директории),
  чтобы обеспечить возможность задать сортировку любых типов
  файлов в конфигурационном файле.

Конфигурационный файл должен выглядеть следующим образом:

```yaml
target_directory: ./MyFolder
sort:
  pdf: "PDFs"
  txt: "TXTs"
  jpg: "JPGs"
  docx: "DOCs"
```

Путь к конфигурационному файлу должен задаваться глобальным флагом в команде `root`
(быть доступным во всех командах).

### 2. Команды

Утилита должна иметь команду `run`:

```bash
organize run
```

Сканирует целевую директорию и перемещает файлы
в подпапки в соответствии с их расширениями.

Пример:

```bash
report.pdf → ./Documents/PDFs/report.pdf
meeting.docx → ./Documents/Docs/meeting.docx
```

Утилита должна иметь команду `list`:

```bash
organize list
```

Показывает все файлы в целевой директории
и их текущее/новое расположение после сортировки.

### 3. Со звездочкой

Эту функциональность реализовывать необязательно,
но можно дополнительно реализовать
(за это будет звездочка в таблице).

```bash
organize run --dry-run
```

Симулирует сортировку (без реального перемещения файлов).
Использует флаг (--dry-run) для включения режима тестирования.

## Наполнитель шаблонов

Написать консольную утилиту с использованием Cobra,
которая заполняет переданный шаблон значениями переменных окружения.

Консольная утилита должна поддерживать следующие возможности:

- команду run для запуска наполнения шаблона,
  в которой будут содержаться флаги для запуска.
- обязательное указание пути к шаблону через `-t` флаг.
- указание пути к результирующему файлу через `-o` флаг.
- возможность выбрать режим заполнения шаблона
  в случае отсутствия переменной окружения,
  используемой в шаблоне через флаг `--strict`:
  завершать работу с ошибкой, или ничего не подставлять,
  если переменная отсутствует.

Пример работы.

Шаблон:

```bash
Hello {{.USER}}!
Current directory: {{.PWD}}
```

Запуск:

```bash
export USER=Alice
go run main.go -t hello.tpl
```

Результат:

```bash
Hello Alice!
Current directory: /home/projects
```

## Библиотека

Реализовать микросервис на Go, позволяющий работать с книгами в библиотеке.
Микросервис должен:

- иметь консольный интерфейс на Cobra;
- читать конфигурационный файл с помощью Viper;
- содержать HTTP сервер с помощью gin-gonic, отвечающий на REST запросы;
- логировать с заданным в конфигурационном файле уровнем логирования;
- содержать тесты с использованием testify.

### Требования к конфигурационному файлу

Должен поддерживаться конфигурационный файл следующего формата:

```yaml
server:
  port: "4444" # На каком порту должен слушать HTTP сервер

logging:
  level: "debug" # Должен поддерживаться любой slog Level
```

Порт приложения должен быть от 1 до 65535.
Уровень логирования должен быть
debug / info / warn / error (как [тут](https://pkg.go.dev/log/slog#Level)).
Приложение должно завершаться с ошибкой,
если в конфигурационном файле заданы значения вне допустимых границ.

### Требования к CLI

Должны поддерживаться следующие команды и флаги:

- глобальный флаг `-c` (`--config`), принимающий путь к конфигурационному файлу.
- глобальный флаг `-l` (`--logger-level`), принимающий уровень логирования.
- команда `serve` с флагом `--port`,
  запускающая HTTP сервер, отвечающий на запросы о книгах.
- команда `help` (должна сама подключаться Cobra).

### Требования к книжному магазину

Книжный магазин должен оперировать информацией о книгах в следующем формате.

```go
type Book struct {
  ID     string `json:"id"`
  Title  string `json:"title"`
  Author string `json:"author"`
  Price  float64 `json:"price"`
}
```

Книжный магазин должен поддерживать следующие HTTP запросы:

| Метод  | Ресурс     | Описание             | Тело запроса | Код состояния      |
| ------ | ---------- | -------------------- | ------------ | ------------------ |
| GET    | /books     | Получить все книги   | -            | 200 OK + []Book    |
| POST   | /books     | Добавить книгу       | Book JSON    | 201 Created + Book |
| GET    | /books/:id | Получить книгу по ID | -            | 200 OK + Book      |
| PUT    | /books/:id | Заменить книгу       | Book JSON    | 200 OK + Book      |
| DELETE | /books/:id | Удалить книгу        | -            | 204 No Content     |

Хранилище книг реализовать с помощью структуры на основе мапы.

### Требования к коду

Сервис должен логировать с использованием slog.
Должны поддерживаться разные уровни логирования.
На логику работы с хранилищем книг нужно написать тесты с использованием testify.

На функцию проверки корректности конфигурационного
файла также должны быть написаны тесты:

- нужно проверять, что приложение корректно обрабатывает порт вне допустимых границ
  (возвращает ошибку, если порт отрицательный, 99990 и т.д.).
- нужно проверять, что приложение корректно обрабатывает недопустимый уровень логирования
  (нельзя указать уровень логирования `abcde`, или `563###`).
